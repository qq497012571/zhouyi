<?php
namespace app\common\helpers;

use Yii;

/**
 * 占卜基础数据
 * @author jlb
 */
class ZhanbuBase
{

	const YIN = '▆　▆';
	const YANG = '▆▆▆';
	const YAO = '☉';

	const TIANGAN = [
		1 => '甲',
		2 => '乙',
		3 => '丙',
		4 => '丁',
		5 => '戊',
		6 => '己',
		7 => '庚',
		8 => '辛',
		9 => '壬',
		10 => '癸',
		0 => '癸'
	];

	const DIZHI = [
		1 => '子',
		2 => '丑',
		3 => '寅',
		4 => '卯',
		5 => '辰',
		6 => '巳',
		7 => '午',
		8 => '未',
		9 => '申',
		10 => '酉',
		11 => '戌',
		12 => '亥',
		0 => '亥'
	];

	const YUEFEN = [
		11 => '子',
		12 => '丑',
		1 => '寅',
		2 => '卯',
		3 => '辰',
		4 => '巳',
		5 => '午',
		6 => '未',
		7 => '申',
		8 => '酉',
		9 => '戌',
		10 => '亥',
	];

	const BAGUA = [
		1 => '乾',
		2 => '兑',
		3 => '离',
		4 => '震',
		5 => '巽',
		6 => '坎',
		7 => '艮',
		8 => '坤',
		0 => '坤',
	];

	const GUA = [
		'乾' => '1|1|1',
		'兑' => '0|1|1',
		'离' => '1|0|1',
		'震' => '0|0|1',
		'巽' => '1|1|0',
		'坎' => '0|1|0',
		'艮' => '1|0|0',
		'坤' => '0|0|0',
	];

	const GUA64 = [
		'1|1|1|1|1|1' => '乾为天',
		'0|0|0|0|0|0' => '坤为地',
		'0|1|0|0|0|1' => '水雷屯',
		'1|0|0|0|1|0' => '山水蒙',
		'0|1|0|1|1|1' => '水天需',
		'1|1|1|0|1|0' => '天水讼',
		'0|0|0|0|1|0' => '地水师',
		'0|1|0|0|0|0' => '水地比',
		'1|1|0|1|1|1' => '风天小畜',
		'1|1|1|0|1|1' => '天泽履',
		'0|0|0|1|1|1' => '地天泰',
		'1|1|1|0|0|0' => '天地否',
		'1|1|1|1|0|1' => '天火同人',
		'1|0|1|1|1|1' => '火天大有',
		'0|0|0|1|0|0' => '地山谦',
		'0|0|1|0|0|0' => '雷地豫',
		'0|0|0|1|0|0' => '泽雷随',
		'1|0|0|1|1|0' => '山风蛊',
		'0|0|0|0|1|1' => '地泽临',
		'1|1|0|0|0|0' => '风地观',
		'1|0|1|0|0|1' => '火雷噬嗑',
		'1|0|0|1|0|1' => '山火贲',
		'1|0|0|0|0|0' => '山地剥',
		'0|0|0|0|0|1' => '地雷复',
		'1|1|1|0|0|1' => '天雷无妄',
		'1|0|0|1|1|1' => '山天大畜',
		'1|0|0|0|0|1' => '山雷颐',
		'0|1|1|1|1|0' => '泽风大过',
		'0|1|0|0|1|0' => '坎为水',
		'1|0|1|1|0|1' => '离为火',
		'0|1|1|1|0|0' => '泽山咸',
		'0|0|1|1|1|0' => '雷风恒',
		'1|1|1|1|0|0' => '天山遁',
		'1|1|1|1|0|0' => '天山遁',
		'0|0|1|1|1|1' => '雷天大壮',
		'1|0|1|0|0|0' => '火地晋',
		'0|0|0|1|0|1' => '地火明夷',
		'1|1|0|1|0|1' => '风火家人',
		'1|0|1|0|1|1' => '火泽睽',
		'0|1|0|1|0|0' => '水山蹇',
		'1|0|0|0|1|1' => '山泽损',
		'1|1|0|0|0|1' => '风雷益',
		'0|1|1|1|1|1' => '泽天夬',
		'1|1|1|1|1|0' => '天风姤',
		'0|1|1|0|0|0' => '泽地萃',
		'0|0|0|1|1|0' => '地风升',
		'0|1|1|0|1|0' => '泽水困',
		'0|1|0|1|1|0' => '水风井',
		'0|1|1|1|0|1' => '泽火革',
		'1|0|1|1|1|0' => '火风鼎',
		'0|0|1|0|0|1' => '震为雷',
		'1|0|0|1|0|0' => '艮为山',
		'1|1|0|1|0|0' => '风山渐',
		'0|0|1|0|1|1' => '雷泽归妹',
		'0|0|1|1|0|1' => '雷火丰',
		'1|0|1|1|0|0' => '火山旅',
		'1|1|0|1|1|0' => '巽为风',
		'0|1|1|0|1|1' => '兑为泽',
		'1|1|0|0|1|0' => '风水涣',
		'0|1|0|0|1|1' => '水泽节',
		'1|1|0|0|1|1' => '风泽中孚',
		'0|0|1|1|0|0' => '雷山小过',
		'0|1|0|1|0|1' => '水火既济',
		'1|0|1|0|1|0' => '火水未济',

	];


	/**
	 * 创建指定卦名的字符串
	 * @param  [type]  $gname [description]
	 * @param  integer $yao   [description]
	 * @return $string
	 */
	public static function get64GuaString($gname, $yao = null)
	{
		$guaCode = array_search($gname, self::GUA64);
		$yaos = array_reverse(explode('|', $guaCode));

		$yaoStr = [];
		foreach ($yaos as $i => $y) {
			if ($y == 1) {
				$yaoStr[] = self::YANG . (($yao && $yao - 1 == $i) ? self::YAO : '');
			} else {
				$yaoStr[] = self::YIN . (($yao && $yao - 1 == $i) ? self::YAO : '');
			}
		}

		$yaoStr[] = $gname;

		if ($yao) {

			foreach ($yaoStr as $i => &$y) {

				if ($i == 1) {
					$y = ($yao <= 3 ? '用' : '体') . $y;
				}

				if ($i == 4) {
					$y = ($yao <= 3 ? '体' : '用') . $y;
				}

				if ($i !== 1 && $i !== 4) {
					$y = '  ' . $y;
				}

			}
			
		}

		return implode("\n", array_reverse($yaoStr));
	}

}